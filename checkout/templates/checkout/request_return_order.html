{% extends "base.html" %}
{% load static %}
{% load crispy_forms_
    tags %}
{% load get_order_status %}
{% block extra_title %}- Request Return Order {% endblock %}


{% block content %}
<div class="overlay"></div>
<div class="container-fluid container-main">
    <div class="row">
        <div class="col text-center">
            <h4>Request Return Order</h4>
            <hr>
        </div>
    </div>
    <div class="row justify-content-center">


        <div class="col-12 col-md-5">
            <form method="POST" action="{% url 'request_order_return' %}" id="return_reason_form">
                {% csrf_token %}
                {{form|crispy}}
        </div>
        </form>

        <div class="col-12 col-md-7">
            <form method="POST" action="{% url 'request_order_return' %}" id="list_order_form">
                {% csrf_token %}
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Order Number</th>
                            <th scope="col">Email Address</th>
                            <th scope="col">Line Items</th>
                            <th scope="col">Action</th>
                        </tr>
                    </thead>
                    <tbody>

                        <tr class="table-dark">

                            <th scope="row"></th>
                            <td>
                                <input type="text" class="small mb-1 w-100"
                                    value={% if query_dict.order_number != None %} {{query_dict.order_number}}
                                    {% else %} '' {% endif %} name="order_number" placeholder="Order Number">
                            </td>
                            <td>
                                <input type="text" class="small mb-1 w-100" value={% if query_dict.email != None %}
                                    {{query_dict.email}} {% else %} '' {% endif %} name="email"
                                    placeholder="Email Address">
                                </button>
                            </td>

                            <td></td>
                            <td> <button type="submit" name="search-btn" class="btn my-btn" title="Click to search">
                                    <i class="fa-solid fa-magnifying-glass"></i></td>
                        </tr>


                        {% for order in orders %}
                        <tr>
                            <th scope="row">{{forloop.counter}}</th>
                            <td class="small">{{ order.order_number }}</td>
                            <td>{{ order.email }}</td>

                            <td>
                                {% for item in order.line_items.all %}
                                <p class="mb-0">Artwork: {{ item.artwork.name }} @
                                    €{{ item.artwork_price |floatformat:"2g" }} </p>
                                <p class="mb-0">Frame: {{ item.frame.name }} @ €{{ item.frame_price |floatformat:"2g"}}
                                </p>
                                <p class="mb-0">Qty: {{ item.quantity }} </p>
                                <p class="mb-1 highlight">Sub Total: €{{ item.line_item_total |floatformat:"2g"}} </p>
                                {% endfor %}
                            </td>
                            <td>
                                <button class="btn btn-select btn-sm">Select</button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </form>
        </div>

    </div>
</div>
</div>
{% endblock %}